<!DOCTYPE html>
<html>
    <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <meta name="robots" content="index, follow">
  <!-- title -->
  
    
  <title>CVE-2023-50692 Recording - Hello Hehanzzz~</title>
    
  
  
  <!-- open graph -->
  <meta name="description" content="CVE-2023-50692">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2023-50692 Recording">
<meta property="og:url" content="https://hehanzzz.github.io/2023/12/25/CVE-2023-50692-Recording/index.html">
<meta property="og:site_name" content="Hello Hehanzzz~">
<meta property="og:description" content="CVE-2023-50692">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255909.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255050.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255451.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255420.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255514.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255168.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255994.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255545.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255652.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255675.png">
<meta property="og:image" content="http://oss.hehanzzz.icu/img/202405061255528.png">
<meta property="article:published_time" content="2023-12-25T13:02:26.000Z">
<meta property="article:modified_time" content="2024-05-06T04:55:52.372Z">
<meta property="article:author" content="Hehanzzz">
<meta property="article:tag" content="CVE-2023-50692">
<meta property="article:tag" content="代码审计">
<meta property="article:tag" content="PHP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://oss.hehanzzz.icu/img/202405061255909.png">
  <!-- canonical -->
  
  <link rel="canonical" href="https://hehanzzz.github.io/2023/12/25/CVE-2023-50692-Recording/">
  
  <!-- Favicon -->
  <link rel="shortcut icon" href="/img/3.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <!-- CSS -->
  
<link rel="stylesheet" href="/css/reset.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/markdown.css">

  
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 7.0.0"></head>

    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <a class="logo" href="/">Hello Hehanzzz~</a>
    <!-- <div class="logo"><a href="/" title="Len"><img src="/img/logo.svg" alt="Len" aria-label="logo" height="20"></a></div> -->
        <ul class="nav">
            
            <li><a href="/">Home</a></li>
            
            <li><a href="/2023/12/31/About-me-%E5%85%B3%E4%BA%8E%E6%88%91/">About</a></li>
            
            <li><a href="/archives">Archives</a></li>
            
        </ul>


    </a>
</div>

                
                <div class="post-main">
    
        <div class="post-main-title">
            CVE-2023-50692 Recording
        </div>
        <div class="post-meta">
            2023-12-25 ｜ 
            
        </div>
        <!-- 圆角分类 -->
        <!-- <div class="tags"> -->
            <!--  -->
        <!-- </div> -->
        <div class="post-md">
            <p>CVE-2023-50692</p>
<span id="more"></span>



<h1 id="0x01-描述"><a href="#0x01-描述" class="headerlink" title="0x01 描述"></a>0x01 描述</h1><p>JIZHICMS V2.5 has background Arbitrary File Downloads causing RCE</p>
<p>Github URL：<a target="_blank" rel="noopener" href="https://github.com/Cherry-toto/jizhicms">Cherry-toto&#x2F;jizhicms: 极致CMS（以下简称:JIZHICMS）是一款开源免费，无商业授权的建站系统。 (github.com)</a></p>
<p>等了蛮久，前几天也是申下来了</p>
<p><img src="http://oss.hehanzzz.icu/img/202405061255909.png"></p>
<h1 id="0x02-漏洞复现"><a href="#0x02-漏洞复现" class="headerlink" title="0x02 漏洞复现"></a>0x02 漏洞复现</h1><ol>
<li>构造一个PHP一句话，然后通过压缩包进行zip格式压缩</li>
</ol>
<p><img src="http://oss.hehanzzz.icu/img/202405061255050.png"></p>
<ol start="2">
<li>将zip上传至VPS服务器上，利用VPS上的python启动一个http服务</li>
</ol>
<p><img src="http://oss.hehanzzz.icu/img/202405061255451.png"></p>
<ol start="3">
<li>登录网站后台，找到 扩展管理 ——&gt; 插件列表，在页面右边的操作中寻找一个没安装过的插件进行下载（同时通过Burp进行抓包）</li>
</ol>
<p><img src="http://oss.hehanzzz.icu/img/202405061255420.png"></p>
<ol start="4">
<li>复制VPS上的压缩包文件URL，将 download_url 参数替换为你的VPS上的zip链接地址，放行这个数据包（但不关闭拦截，因为后面还有数个数据包的url需要替换）</li>
</ol>
<p><img src="http://oss.hehanzzz.icu/img/202405061255514.png"></p>
<p>例如：</p>
<p><img src="http://oss.hehanzzz.icu/img/202405061255168.png"></p>
<ol start="5">
<li>然后重复数此这种操作，将原本指定来着 down.jizhicms.cn 的url全部替换</li>
</ol>
<p><img src="http://oss.hehanzzz.icu/img/202405061255994.png"></p>
<p>可以看到VPS上返回了这个请求</p>
<p><img src="http://oss.hehanzzz.icu/img/202405061255545.png"></p>
<ol start="6">
<li>然后访问漏洞网站，目录是 &#x2F;app&#x2F;admin&#x2F;exts&#x2F; 加上第一步构造的PHP一句话木马的文件名</li>
</ol>
<p><img src="http://oss.hehanzzz.icu/img/202405061255652.png"></p>
<h1 id="0x03-漏洞分析"><a href="#0x03-漏洞分析" class="headerlink" title="0x03 漏洞分析"></a>0x03 漏洞分析</h1><p>在位于 app&#x2F;admin&#x2F;c&#x2F;PluginsController.php 的文件中的 update 方法中，$remote_url 并未对url进行安全检验，导致可以远程下载任意zip文件，并在后面的代码中可以看到进行解压</p>
<p><img src="http://oss.hehanzzz.icu/img/202405061255675.png"></p>
<p>根据719行的代码可以知道，下载解压后的文件存放在 app&#x2F;admin&#x2F;exts 下</p>
<p><img src="http://oss.hehanzzz.icu/img/202405061255528.png"></p>
<h1 id="0x04-思考"><a href="#0x04-思考" class="headerlink" title="0x04 思考"></a>0x04 思考</h1><p>以前总是觉得说进到后台就算是拿下一台主机了，不再深入，因此对后台的洞了解甚少</p>
<p>看了很多cms的后台洞，发现大家更倾向于寻找Rce的点，而不是后台Sql注入</p>
<p>主要还是为了拿shell做更多事情（旁站攻击或者打内网……）</p>
<p>其中插件这个模块出现洞的频率最高，不管是在Awdp中还是日常审计中都是重点关注的对象</p>
<p>大多数的原因都是因为允许本地上传插件或者原创下载（包括在这个CVE中，作者其实并不承认这算是漏洞，觉得这是他cms的一个特性）</p>
<p>所以快速探究有没有这个洞，最好最快的方法其实是黑盒看有没有这个功能点，而不是白盒一个个审计</p>

        </div>
    
<!-- tags -->

    <div class="post-meta">
        标签：
        
            <a href="/tags/CVE-2023-50692/"> / CVE-2023-50692</a>
        
            <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"> / 代码审计</a>
        
            <a href="/tags/PHP/"> / PHP</a>
        
    </div>

</div>
                <div class="footer">
    <span>Copyright © <script>document.write(new Date().getFullYear())</script> Hello Hehanzzz~</span>
    <span>Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> with <a target="_blank" rel="noopener" href="https:///imzl.com/zenmind">ZenMind</a></span>
</div>

<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>

<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    </body>
</html>